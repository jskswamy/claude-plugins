{"id":"claude-plugins-pb3","title":"Add jail.nix support to devenv plugin","description":"Add support for jail.nix (https://git.sr.ht/~alexdavid/jail.nix) to the /devenv plugin for sandboxed development environments.\n\n## ⚠️ PLATFORM LIMITATION: Linux Only\n\n**jail.nix uses bubblewrap which is Linux-only.** Bubblewrap relies on Linux kernel namespaces (user namespaces, mount namespaces, cgroups, seccomp) which do not exist on macOS.\n\nmacOS uses different sandboxing: sandbox-exec with Seatbelt profiles (App Sandbox). These are fundamentally incompatible approaches.\n\n**Options:**\n1. Implement Linux-only (document limitation clearly)\n2. Future: Add macOS support via sandbox-exec (separate implementation)\n3. Alternative: Use Anthropic's sandbox-runtime which supports both platforms\n\n## What is jail.nix?\n\nA Nix library that wraps derivations in bubblewrap for security sandboxing:\n- Minimal permissions by default\n- Combinators for permissions: network, gui, gpu, readonly, rw-bind\n- Flake integration: inputs.jail-nix.url = \"sourcehut:~alexdavid/jail.nix\"\n- Automatic path escaping for security\n\n## Current devenv Plugin Architecture\n\n- Location: plugins/devenv/\n- Commands: commands/devenv.md (702 lines) - Initialize/manage flows\n- Hooks: PostToolUse for nixfmt, statix, deadnix\n- Config: .claude/devenv.local.md for user preferences\n\n## Implementation Approach\n\n1. Add jail.nix to security tools selection (alongside pre-commit, gitleaks)\n2. **Detect platform and skip/warn on macOS**\n3. Add sandbox policy options: strict, standard, permissive\n4. Update flake template with jail.nix input\n5. Wrap packages with jail combinators based on policy\n6. Add management menu option for existing environments","design":"## Files to Modify\n\n- plugins/devenv/commands/devenv.md - Add jail.nix to security tools flow\n- plugins/devenv/README.md - Document sandboxing feature\n- plugins/devenv/.claude-plugin/plugin.json - Add keywords\n\n## Flake Template Changes\n\nAdd input:\n```nix\ninputs.jail.url = \"sourcehut:~alexdavid/jail.nix\";\n```\n\nInitialize in outputs:\n```nix\njail = inputs.jail.lib.init pkgs;\n```\n\nWrap packages:\n```nix\npackages = with pkgs; [\n  (jail.wrap nodejs [ jail.network ])\n  (jail.wrap python3 [ jail.network (jail.readonly \"/etc\") ])\n];\n```\n\n## Configuration\n\nAdd to .claude/devenv.local.md:\n```yaml\nuse_jail_sandbox: false\njail_policy: standard  # strict, standard, permissive\n```\n\n## Policy Presets\n\n- strict: No network, no GUI, minimal filesystem\n- standard: Network access, read-only common paths\n- permissive: Network + GUI + GPU access","acceptance_criteria":"- [ ] jail.nix appears in security tools selection during init (Linux only)\n- [ ] Platform detection: Skip/warn jail.nix option on macOS\n- [ ] User can choose sandbox policy (strict/standard/permissive)\n- [ ] Generated flake.nix includes jail.nix input when selected\n- [ ] Packages wrapped with appropriate combinators per policy\n- [ ] Existing environments can add sandboxing via manage flow\n- [ ] Configuration persisted in devenv.local.md\n- [ ] nix flake check passes with jail.nix integration\n- [ ] README documents jail.nix feature AND Linux-only limitation","notes":"## Platform Support\n\n| Platform | Support | Reason |\n|----------|---------|--------|\n| Linux | ✅ Full | bubblewrap uses Linux namespaces |\n| macOS | ❌ None | No kernel namespace support |\n| WSL2 | ✅ Works | Linux kernel under the hood |\n\n## Why bubblewrap doesn't work on macOS\n\nBubblewrap requires Linux kernel features:\n- User namespaces (CONFIG_USER_NS)\n- Mount namespaces\n- PID/Network/IPC namespaces\n- cgroups\n- seccomp filtering\n\nmacOS lacks all of these. Even running in Docker/Podman on macOS fails because Apple's virtualization layer doesn't properly expose namespace capabilities to containers.\n\n## Potential Future: Cross-Platform Alternative\n\nAnthropic's sandbox-runtime (https://github.com/anthropic-experimental/sandbox-runtime) provides:\n- macOS: sandbox-exec with Seatbelt profiles\n- Linux: bubblewrap\n\nThis could be a future enhancement to support both platforms.\n\n## References\n\n- bubblewrap: https://github.com/containers/bubblewrap\n- jail.nix: https://git.sr.ht/~alexdavid/jail.nix\n- sandbox-runtime: https://github.com/anthropic-experimental/sandbox-runtime","status":"open","priority":2,"issue_type":"feature","owner":"jskswamy@gmail.com","created_at":"2026-01-14T21:49:18.079001+05:30","created_by":"Krishnaswamy Subramanian","updated_at":"2026-01-15T01:23:46.705808+05:30","labels":["linux-only","parked"]}
{"id":"claude-plugins-u8c","title":"Add sketch summarization option to jot plugin","description":"Add sketch-note integration to the jot plugin for visual summaries of captured content.\n\n## Current jot Plugin\n\n- Location: plugins/jot/\n- Agents: quick-capture.md (text), capture.md (URL-based)\n- Templates: article, video, blip, person, book, research\n- Output: notes/{type}/*.md\n\n## Current Summarization\n\n| Type | Length | Focus |\n|------|--------|-------|\n| article | 60-100+ lines | Key insights |\n| video | 80-130+ lines | Timestamps, quotes |\n| blip | 80-120+ lines | Features, comparisons |\n| book | 60-100+ lines | Reflections |\n\n## Implementation Approach\n\n1. Add --sketch flag to /capture command\n2. Extract key concepts for visualization per content type\n3. Generate Excalidraw diagram via sketch-note plugin\n4. Save sketch alongside markdown note with cross-links\n5. Optional auto-sketch for configured types","design":"## Files to Modify\n\n- plugins/jot/commands/capture.md - Add --sketch flag\n- plugins/jot/agents/capture.md - Add sketch generation step\n- plugins/jot/templates/capture/article.md - Add visual section\n- plugins/jot/templates/capture/video.md - Add visual section\n- plugins/jot/templates/capture/blip.md - Add visual section\n- plugins/jot/README.md - Document sketch feature\n\n## Configuration\n\nAdd to .claude/jot.local.md:\n```yaml\nauto_sketch_types: []  # article, video, blip\nsketch_style: hand-drawn  # hand-drawn, sketchy, clean\n```\n\n## Sketch Content per Type\n\n### Articles\n- Central: Article title\n- Branches: Key points (4-5)\n- Layout: Radial mind-map\n\n### Videos  \n- Central: Video title\n- Branches: Key topics with timestamps\n- Layout: Hierarchical timeline\n\n### Blips (Tech Radar)\n- Central: Tool name\n- Branches: Features, Strengths, Considerations\n- Ring/Quadrant indicators\n- Layout: Structured grid\n\n### Books\n- Central: Title + author\n- Branches: Key topics/chapters\n- Layout: Hierarchical\n\n## Output Structure\n\n```\n${WORKBENCH_PATH}/notes/\n├── articles/article-name.md\n├── videos/video-name.md\n└── sketches/article-name.excalidraw  # NEW\n```\n\n## Cross-Linking\n\nIn markdown: Visual: [[sketches/article-name]]\nIn sketch: Source link back to note","acceptance_criteria":"- [ ] /capture article URL --sketch generates markdown + visual\n- [ ] /capture video URL --sketch generates visual with timestamps\n- [ ] /capture blip URL --sketch generates tech radar visual\n- [ ] auto_sketch_types config works for automatic generation\n- [ ] Sketches saved to notes/sketches/ directory\n- [ ] Markdown notes link to corresponding sketches\n- [ ] Works with sketch-note styles (hand-drawn, sketchy, clean)\n- [ ] README documents sketch integration","notes":"## Dependencies\n\n- sketch-note plugin must be installed\n- Optional: PNG export (claude-plugins-uz6)\n\n## User Flow Example\n\n```\n/capture article https://martinfowler.com/microservices.html --sketch\n\n1. Fetch article content\n2. Ask discovery context\n3. Generate markdown (60-100 lines)\n4. Extract concepts: Microservices, Componentization, Decentralized...\n5. Generate Excalidraw diagram\n6. Save: notes/articles/microservices.md + notes/sketches/microservices.excalidraw\n```","status":"open","priority":2,"issue_type":"feature","owner":"jskswamy@gmail.com","created_at":"2026-01-14T21:49:18.532911+05:30","created_by":"Krishnaswamy Subramanian","updated_at":"2026-01-15T01:11:53.271732+05:30"}
{"id":"claude-plugins-uz6","title":"Add PNG export option to sketch plugin","description":"Add PNG export capability to the sketch-note plugin, which currently only generates Excalidraw JSON files.\n\n## Current sketch-note Plugin\n\n- Location: plugins/sketch-note/\n- Output: sketches/*.excalidraw (JSON files only)\n- Styles: hand-drawn (roughness 2), sketchy (1), clean (0)\n- Templates: conversation, code-architecture, custom\n\n## Available CLI Tools\n\n### excalidraw-brute-export-cli (Recommended)\n- Uses Playwright + headless Firefox\n- Exact Excalidraw export fidelity\n- Install: npm install -g excalidraw-brute-export-cli\n- Usage: excalidraw-brute-export-cli -i file.excalidraw --format png -o file.png\n\n### @tommywalkie/excalidraw-cli (Alternative)\n- Uses node-canvas + Rough.js (no browser)\n- Faster but may not match 100%\n- Install: npm install -g @tommywalkie/excalidraw-cli\n- Usage: excalidraw-cli file.excalidraw .\n\n## Implementation Approach\n\n1. Add --format flag: excalidraw|png|both\n2. Add png_scale preference (1x, 2x, 4x)\n3. Create export script that tries available CLI tools\n4. Update generation workflow to export PNG when requested","design":"## Files to Modify/Create\n\n- plugins/sketch-note/commands/sketch.md - Add --format option\n- plugins/sketch-note/scripts/export-png.sh - New export script\n- plugins/sketch-note/README.md - Document PNG export\n\n## Command Changes\n\nAdd argument: --format excalidraw|png|both (default: excalidraw)\n\nAdd AskUserQuestion:\n```\nOutput format:\n○ Excalidraw only (.excalidraw) - Editable\n○ PNG only (.png) - Shareable image  \n○ Both formats (Recommended)\n```\n\n## Configuration\n\nAdd to .claude/sketch-note.local.md:\n```yaml\noutput_format: excalidraw  # excalidraw, png, both\npng_scale: 2  # 1, 2, 4\n```\n\n## Export Script (scripts/export-png.sh)\n\n```bash\n#!/bin/bash\nINPUT=\"$1\"\nOUTPUT=\"${INPUT%.excalidraw}.png\"\nSCALE=\"${2:-2}\"\n\nif command -v excalidraw-brute-export-cli \u0026\u003e /dev/null; then\n  excalidraw-brute-export-cli -i \"$INPUT\" --format png --scale \"$SCALE\" -o \"$OUTPUT\"\nelif command -v excalidraw-cli \u0026\u003e /dev/null; then\n  excalidraw-cli \"$INPUT\" \"$(dirname \"$OUTPUT\")\"\nelse\n  echo \"Install: npm i -g excalidraw-brute-export-cli\"\n  exit 1\nfi\n```\n\n## Dependencies\n\n- Node.js 18+\n- excalidraw-brute-export-cli OR @tommywalkie/excalidraw-cli\n- Playwright + Firefox (for brute-export)","acceptance_criteria":"- [ ] /sketch --format png generates PNG file\n- [ ] /sketch --format both generates .excalidraw and .png\n- [ ] PNG scale configurable (1x, 2x, 4x)\n- [ ] Graceful fallback when CLI tools not installed\n- [ ] Clear installation instructions for dependencies\n- [ ] Works with all templates (conversation, architecture, custom)\n- [ ] Works with all styles (hand-drawn, sketchy, clean)\n- [ ] README documents PNG export feature","status":"open","priority":2,"issue_type":"feature","owner":"jskswamy@gmail.com","created_at":"2026-01-14T21:49:18.324678+05:30","created_by":"Krishnaswamy Subramanian","updated_at":"2026-01-15T01:10:32.45063+05:30"}
